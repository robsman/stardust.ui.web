/*******************************************************************************
 * Copyright (c) 2011 SunGard CSA LLC and others. All rights reserved. This
 * program and the accompanying materials are made available under the terms of
 * the Eclipse Public License v1.0 which accompanies this distribution, and is
 * available at http://www.eclipse.org/legal/epl-v10.html
 *
 * Contributors: SunGard CSA LLC - initial API and implementation and/or initial
 * documentation
 ******************************************************************************/

/**
 * @author Zachary Z McCain
 */

(function(){
	
	'use strict';
	
	/**
	 * Constructor for the benchmarkService. Expose required injected
	 * dependencies and set up our URL values we will need.
	 */
	function benchmarkService($q, $http, $location){
		
		//Add dependencies to self so we can reference them in prototypes.
		this.$q = $q;
		this.$http = $http;
		this.$location = $location;
		
		//Calculate URLs we will need.
		this.absUrl = $location.absUrl();
		
		//TODO: plugins is not part of base url, find out why and fix
		this.absRoot = "http://localhost:8080/ipp82rc1"; //this.absUrl.substring(0,this.absUrl.indexOf("/plugins"));
		
		this.rootUrl = this.absRoot + "/services/rest/benchmark";
		
	}
	
	/**
	 * Retrieve calendars from the calendar plugin.
	 * @param pluginId - Id of the calendar plugin, defaults to 'timeOffCalendar'
	 */
	benchmarkService.prototype.getCalendars = function(pluginId){
		var url,
			deferred = this.$q.defer();
		
		pluginId = pluginId || 'timeOffCalendar';
		
		url = this.absRoot + '/services/rest/business-calendar/groups/' + pluginId + ".json";
	
		this.$http.get(url)
		.success(function(data){
			deferred.resolve(data);
		})
		.error(function(err){
			deferred.reject(err);
		});
	
		return deferred.promise;
		
	}
	
	/**
	 * Retrieve all deployed models.
	 * @returns
	 */
	benchmarkService.prototype.getModels = function(){
		var deferred = this.$q.defer(),
			url = this.rootUrl + "/models.json";
		
		this.$http.get(url)
		.success(function(data){
			deferred.resolve(data);
		})
		.error(function(err){
			deferred.reject(err);
		});

		return deferred.promise;
	};
	
	
	/**
	 * retrieve all benchmarks
	 * @returns
	 */
	benchmarkService.prototype.getBenchmarks = function(id){
		var deferred = this.$q.defer(),
		    mockBenchmarks = [];
		
		//TODO: remove mock data and pull from server
		//mockBenchmarks.push({"benchmark":{"id":"uuid1","name":"General Processing 1","description":"General Benchmarks","author":"motu","lastModified":"2015-03-12 00:00 | UTC","validFrom":"2015-03-12 00:00 | UTC","categories":[{"id":1,"name":"On Time","color":"#00FF00","range":{"low":0,"high":333}},{"id":3,"name":"Almost Late","color":"#FFFF00","range":{"low":334,"high":666}},{"id":3,"name":"Late","color":"#FF0000","range":{"low":667,"high":1000}}],"models":[{"id":"modelId","oid":"modelOid","benchmarkData":{"enableDueDate":true,"isFreeForm":false,"freeFormScript":"","dueDate":{"dataReference":"businessData","dayType":"businessDays","offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},"categories":[{"categoryId":1,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}}]},processDefinitions:[{"id":"process-definition Id","oid":1,"benchmarkData":{"enableDueDate":true,"isFreeForm":false,"freeFormScript":"","dueDate":{"dataReference":"businessData","dayType":"businessDays","offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},"categories":[{"categoryId":1,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}}]},"activities":[{"id":"activityId","oid":3,"benchmarkData":{"enableDueDate":true,"isFreeForm":false,"freeFormScript":"","dueDate":{"dataReference":"businessData","dayType":"businessDays","offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},"categories":[{"categoryId":1,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}}]}}]},{"id":"process-definition Id","oid":2,"benchmarkData":{"enableDueDate":true,"isFreeForm":false,"freeFormScript":"","dueDate":{"dataReference":"businessData","dayType":"businessDays","offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},"categories":[{"categoryId":1,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}}]},"activities":[]}]}]}});
		//mockBenchmarks.push({"benchmark":{"id":"uuid2","name":"General Processing 2","description":"General Benchmarks","author":"motu","lastModified":"2015-03-12 00:00 | UTC","validFrom":"2015-03-12 00:00 | UTC","categories":[{"id":1,"name":"On Time","color":"#00FF00","range":{"low":0,"high":333}},{"id":3,"name":"Almost Late","color":"#FFFF00","range":{"low":334,"high":666}},{"id":3,"name":"Late","color":"#FF0000","range":{"low":667,"high":1000}}],"models":[{"id":"modelId","oid":"modelOid","benchmarkData":{"enableDueDate":true,"isFreeForm":false,"freeFormScript":"","dueDate":{"dataReference":"businessData","dayType":"businessDays","offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},"categories":[{"categoryId":1,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}}]},processDefinitions:[{"id":"process-definition Id","oid":1,"benchmarkData":{"enableDueDate":true,"isFreeForm":false,"freeFormScript":"","dueDate":{"dataReference":"businessData","dayType":"businessDays","offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},"categories":[{"categoryId":1,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}}]},"activities":[{"id":"activityId","oid":3,"benchmarkData":{"enableDueDate":true,"isFreeForm":false,"freeFormScript":"","dueDate":{"dataReference":"businessData","dayType":"businessDays","offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},"categories":[{"categoryId":1,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}}]}}]},{"id":"process-definition Id","oid":2,"benchmarkData":{"enableDueDate":true,"isFreeForm":false,"freeFormScript":"","dueDate":{"dataReference":"businessData","dayType":"businessDays","offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},"categories":[{"categoryId":1,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}}]},"activities":[]}]}]}});
	    //mockBenchmarks.push({"benchmark":{"id":"uuid3","name":"General Processing 3","description":"General Benchmarks","author":"motu","lastModified":"2015-03-12 00:00 | UTC","validFrom":"2015-03-12 00:00 | UTC","categories":[{"id":1,"name":"On Time","color":"#00FF00","range":{"low":0,"high":333}},{"id":3,"name":"Almost Late","color":"#FFFF00","range":{"low":334,"high":666}},{"id":3,"name":"Late","color":"#FF0000","range":{"low":667,"high":1000}}],"models":[{"id":"modelId","oid":"modelOid","benchmarkData":{"enableDueDate":true,"isFreeForm":false,"freeFormScript":"","dueDate":{"dataReference":"businessData","dayType":"businessDays","offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},"categories":[{"categoryId":1,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}}]},processDefinitions:[{"id":"process-definition Id","oid":1,"benchmarkData":{"enableDueDate":true,"isFreeForm":false,"freeFormScript":"","dueDate":{"dataReference":"businessData","dayType":"businessDays","offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},"categories":[{"categoryId":1,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}}]},"activities":[{"id":"activityId","oid":3,"benchmarkData":{"enableDueDate":true,"isFreeForm":false,"freeFormScript":"","dueDate":{"dataReference":"businessData","dayType":"businessDays","offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},"categories":[{"categoryId":1,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}}]}}]},{"id":"process-definition Id","oid":2,"benchmarkData":{"enableDueDate":true,"isFreeForm":false,"freeFormScript":"","dueDate":{"dataReference":"businessData","dayType":"businessDays","offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},"categories":[{"categoryId":1,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}}]},"activities":[]}]}]}});
		
		//mockBenchmarks.push({"meta":{"modifiedBy":"Frank, Johnson","lastModified":"2012-01-0112: 00AM"},"benchmark":{"id":"uuid1","name":"GeneralProcessing1","description":"GeneralBenchmarks","defaults":{"processDefinitions":{"dueDate":{"enabled":true,"dataReference":"BUSINESS_DATE","useBusinessDays":true,"offset":{"amount":10,"unit":"d","time":"12:01 AM"}},"enableBenchmark":true,"categoryConditions":[{"categoryId":"77df2bb8-af69-426e-be59-84b18f04cc30","type":"freeform","freeformExpression":""},{"categoryId":"d1fee32c-cb5b-4637-bb5d-b611acfe636a","type":"freeform","freeformExpression":""},{"categoryId":"00910fc6-0637-47a0-ad33-19180090b967","type":"freeform","freeformExpression":""}]},"activities":{"enableBenchmark":true,"categoryConditions":[{"categoryId":"77df2bb8-af69-426e-be59-84b18f04cc30","type":"freeform","freeformExpression":""},{"categoryId":"d1fee32c-cb5b-4637-bb5d-b611acfe636a","type":"freeform","freeformExpression":""},{"categoryId":"00910fc6-0637-47a0-ad33-19180090b967","type":"freeform","freeformExpression":""}]}},"categories":[{"id":"1111-1111-1111-1111","name":"OnTime","color":"#00FF00","index":1},{"id":"2222-2222-2222-2222","name":"AlmostLate","color":"#FFFF00","index":2},{"id":"3333-3333-3333-3333","name":"Late","color":"#FF0000","index":3}],"models":[{"id":"modelId",processDefinitions:[{"id":"process-definitionId","enableBenchmark":true,"categoryConditions":{"enableDueDate":true,"isFreeForm":false,"freeFormScript":"","dueDate":{"dataReference":"businessData","dayType":"businessDays","offset":{"amount":10,"unit":"d","offsetTime":"12: 01AM"}},"categories":[{"categoryId":1,"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12: 01AM"}},{"categoryId":2,"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12: 01AM"}},{"categoryId":2,"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12: 01AM"}}]},"activities":[{"id":"activityId","enableBenchmark":true,"categoryConditions":{"enableDueDate":true,"isFreeForm":false,"freeFormScript":"","dueDate":{"dataReference":"businessData","dayType":"businessDays","offset":{"amount":10,"unit":"d","offsetTime":"12: 01AM"}},"categories":[{"categoryId":1,"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12: 01AM"}},{"categoryId":2,"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12: 01AM"}},{"categoryId":2,"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12: 01AM"}}]}}]},{"id":"process-definitionId","enableBenchmark":true,"categoryConditions":{"enableDueDate":true,"isFreeForm":false,"freeFormScript":"","dueDate":{"dataReference":"businessData","dayType":"businessDays","offset":{"amount":10,"unit":"d","offsetTime":"12: 01AM"}},"categories":[{"categoryId":1,"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12: 01AM"}},{"categoryId":2,"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12: 01AM"}},{"categoryId":2,"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12: 01AM"}}]},"activities":[]}]}]}});
	    //mockBenchmarks={"benchmarkDefinitions":[{"metadata":{"author":"motu","lastModifiedDate":"1312332132"},"content":{"id":"uuid1","name":"GeneralProcessing1","description":"GeneralBenchmarks","defaults":{"processDefinitions":{"dueDate":{"enabled":true,"dataReference":"BUSINESS_DATE","useBusinessDays":true,"offset":{"amount":10,"unit":"d","time":"12:01 AM"}},"enableBenchmark":true,"categoryConditions":[{"categoryId":"77df2bb8-af69-426e-be59-84b18f04cc30","type":"freeform","freeformExpression":""},{"categoryId":"d1fee32c-cb5b-4637-bb5d-b611acfe636a","type":"freeform","freeformExpression":""},{"categoryId":"00910fc6-0637-47a0-ad33-19180090b967","type":"freeform","freeformExpression":""}]},"activities":{"enableBenchmark":true,"categoryConditions":[{"categoryId":"77df2bb8-af69-426e-be59-84b18f04cc30","type":"freeform","freeformExpression":""},{"categoryId":"d1fee32c-cb5b-4637-bb5d-b611acfe636a","type":"freeform","freeformExpression":""},{"categoryId":"00910fc6-0637-47a0-ad33-19180090b967","type":"freeform","freeformExpression":""}]}},"categories":[{"id":"1111-1111-1111-1111","name":"OnTime","color":"#00FF00","index":1,"$$hashKey":"06X"},{"id":"2222-2222-2222-2222","name":"AlmostLate","color":"#FFFF00","index":2,"$$hashKey":"06Y"},{"id":"3333-3333-3333-3333","name":"Late","color":"#FF0000","index":3,"$$hashKey":"06Z"}],"models":[{"id":"modelId","processDefinitions":[{"id":"process-definitionId","enableBenchmark":true,"categoryConditions":{"enableDueDate":true,"isFreeForm":false,"freeFormScript":"","dueDate":{"dataReference":"businessData","dayType":"businessDays","offset":{"amount":10,"unit":"d","offsetTime":"12: 01AM"}},"categories":[{"categoryId":1,"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12: 01AM"}},{"categoryId":2,"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12: 01AM"}},{"categoryId":2,"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12: 01AM"}}]},"activities":[{"id":"activityId","enableBenchmark":true,"categoryConditions":{"enableDueDate":true,"isFreeForm":false,"freeFormScript":"","dueDate":{"dataReference":"businessData","dayType":"businessDays","offset":{"amount":10,"unit":"d","offsetTime":"12: 01AM"}},"categories":[{"categoryId":1,"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12: 01AM"}},{"categoryId":2,"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12: 01AM"}},{"categoryId":2,"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12: 01AM"}}]}}]},{"id":"process-definitionId","enableBenchmark":true,"categoryConditions":{"enableDueDate":true,"isFreeForm":false,"freeFormScript":"","dueDate":{"dataReference":"businessData","dayType":"businessDays","offset":{"amount":10,"unit":"d","offsetTime":"12: 01AM"}},"categories":[{"categoryId":1,"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12: 01AM"}},{"categoryId":2,"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12: 01AM"}},{"categoryId":2,"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12: 01AM"}}]},"activities":[]}]},{"id":"Model19","processDefinitions":[{"id":"FundProcOUT","categoryConditions":[{"categoryId":"1111-1111-1111-1111","type":"default","freeFormExpression":"","details":{"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate","offset":{"applyOffset":false,"useBusinessDays":false,"amount":0,"unit":"d","offsetTime":"00:00 AM"}}}},{"categoryId":"2222-2222-2222-2222","type":"default","freeFormExpression":"","details":{"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate","offset":{"applyOffset":false,"useBusinessDays":false,"amount":0,"unit":"d","offsetTime":"00:00 AM"}}}},{"categoryId":"3333-3333-3333-3333","type":"default","freeFormExpression":"","details":{"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate","offset":{"applyOffset":false,"useBusinessDays":false,"amount":0,"unit":"d","offsetTime":"00:00 AM"}}}}],"enableBenchmark":true,"activities":[{"id":"SubProcOut","enableBenchmark":true,"categoryConditions":[{"categoryId":"1111-1111-1111-1111","type":"default","freeFormExpression":"","details":{"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate","offset":{"applyOffset":false,"useBusinessDays":false,"amount":0,"unit":"d","offsetTime":"00:00 AM"}}},"$$hashKey":"085"},{"categoryId":"2222-2222-2222-2222","type":"default","freeFormExpression":"","details":{"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate","offset":{"applyOffset":false,"useBusinessDays":false,"amount":0,"unit":"d","offsetTime":"00:00 AM"}}},"$$hashKey":"086"},{"categoryId":"3333-3333-3333-3333","type":"default","freeFormExpression":"","details":{"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate","offset":{"applyOffset":false,"useBusinessDays":false,"amount":0,"unit":"d","offsetTime":"00:00 AM"}}},"$$hashKey":"087"}]}],"dueDate":{"enabled":true,"dataReference":"","offset":{"useBusinessDays":true,"amount":0,"unit":"d","time":"12:00 AM"}}},{"id":"FundProcIN","categoryConditions":[{"categoryId":"1111-1111-1111-1111","type":"default","freeFormExpression":"","details":{"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate","offset":{"applyOffset":false,"useBusinessDays":false,"amount":0,"unit":"d","offsetTime":"00:00 AM"}}}},{"categoryId":"2222-2222-2222-2222","type":"default","freeFormExpression":"","details":{"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate","offset":{"applyOffset":false,"useBusinessDays":false,"amount":0,"unit":"d","offsetTime":"00:00 AM"}}}},{"categoryId":"3333-3333-3333-3333","type":"default","freeFormExpression":"","details":{"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate","offset":{"applyOffset":false,"useBusinessDays":false,"amount":0,"unit":"d","offsetTime":"00:00 AM"}}}}],"enableBenchmark":true,"activities":[{"id":"SubprocIN","enableBenchmark":true,"categoryConditions":[{"categoryId":"1111-1111-1111-1111","type":"default","freeFormExpression":"","details":{"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate","offset":{"applyOffset":false,"useBusinessDays":false,"amount":0,"unit":"d","offsetTime":"00:00 AM"}}}},{"categoryId":"2222-2222-2222-2222","type":"default","freeFormExpression":"","details":{"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate","offset":{"applyOffset":false,"useBusinessDays":false,"amount":0,"unit":"d","offsetTime":"00:00 AM"}}}},{"categoryId":"3333-3333-3333-3333","type":"default","freeFormExpression":"","details":{"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate","offset":{"applyOffset":false,"useBusinessDays":false,"amount":0,"unit":"d","offsetTime":"00:00 AM"}}}}]}],"dueDate":{"enabled":true,"dataReference":"","offset":{"useBusinessDays":true,"amount":0,"unit":"d","time":"12:00 AM"}}}]}]}}]};
		mockBenchmarks = {"benchmarkDefinitions":[{"metadata":{"modifiedBy":"motu","lastModifiedDate":12312313232},"content":{"id":"","name":"Default Benchmark Prime","description":"","categories":[{"id":"91cd7f6e-a4e0-4456-9c86-a172fdaec058","name":"Default Category","color":"#00FF00","$$hashKey":"07J","index":0}],"models":[{"id":"Model19","processDefinitions":[{"id":"FundProcOUT","categoryConditions":[{"categoryId":"91cd7f6e-a4e0-4456-9c86-a172fdaec058","type":"default","freeFormExpression":"","details":{"condition":{"lhs":"CurrentTime","operator":"NotLaterThan","rhs":"BusinessDate","offset":{"applyOffset":true,"useBusinessDays":"true","amount":0,"unit":"d","offsetTime":"00:00 AM"}}}}],"enableBenchmark":true,"activities":[{"id":"SubProcOut","enableBenchmark":true,"categoryConditions":[{"categoryId":"91cd7f6e-a4e0-4456-9c86-a172fdaec058","type":"default","freeFormExpression":"sdasadsaddsa","details":{"condition":{"lhs":"FreeForm","operator":"NotLaterThan","rhs":"BusinessDate","offset":{"applyOffset":false,"useBusinessDays":false,"amount":0,"unit":"d","offsetTime":"00:00 AM"}}},"$$hashKey":"07Z"}]}],"dueDate":{"enabled":true,"dataReference":"","offset":{"useBusinessDays":true,"amount":0,"unit":"d","time":"12:00 AM"},"dateReference":"businessDate"}}]}]}}]};
		mockBenchmarks = {"benchmarkDefinitions":[]};
		deferred.resolve(mockBenchmarks);

		return deferred.promise;
	}
	
	/**
	 * retrieve a specific defined benchmarks
	 * @returns
	 */
	benchmarkService.prototype.getBenchmark = function(id){
		var deferred = this.$q.defer(),
		    mockBenchmarks = {};
		
		//TODO: remove mock data and pull from server
		mockBenchmarks.uuid1 = {"benchmark":{"id":"uuid1","name":"General Processing 1","description":"General Benchmarks","author":"motu","lastModified":"2015-03-12 00:00 | UTC","validFrom":"2015-03-12 00:00 | UTC","categories":[{"id":1,"name":"On Time","color":"#00FF00","range":{"low":0,"high":333}},{"id":3,"name":"Almost Late","color":"#FFFF00","range":{"low":334,"high":666}},{"id":3,"name":"Late","color":"#FF0000","range":{"low":667,"high":1000}}],"models":[{"id":"modelId","oid":"modelOid","benchmarkData":{"enableDueDate":true,"isFreeForm":false,"freeFormScript":"","dueDate":{"dataReference":"businessData","dayType":"businessDays","offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},"categories":[{"categoryId":1,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}}]},processDefinitions:[{"id":"process-definition Id","oid":1,"benchmarkData":{"enableDueDate":true,"isFreeForm":false,"freeFormScript":"","dueDate":{"dataReference":"businessData","dayType":"businessDays","offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},"categories":[{"categoryId":1,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}}]},"activities":[{"id":"activityId","oid":3,"benchmarkData":{"enableDueDate":true,"isFreeForm":false,"freeFormScript":"","dueDate":{"dataReference":"businessData","dayType":"businessDays","offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},"categories":[{"categoryId":1,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}}]}}]},{"id":"process-definition Id","oid":2,"benchmarkData":{"enableDueDate":true,"isFreeForm":false,"freeFormScript":"","dueDate":{"dataReference":"businessData","dayType":"businessDays","offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},"categories":[{"categoryId":1,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}}]},"activities":[]}]}]}};
		mockBenchmarks.uuid2 = {"benchmark":{"id":"uuid2","name":"General Processing 2","description":"General Benchmarks","author":"motu","lastModified":"2015-03-12 00:00 | UTC","validFrom":"2015-03-12 00:00 | UTC","categories":[{"id":1,"name":"On Time","color":"#00FF00","range":{"low":0,"high":333}},{"id":3,"name":"Almost Late","color":"#FFFF00","range":{"low":334,"high":666}},{"id":3,"name":"Late","color":"#FF0000","range":{"low":667,"high":1000}}],"models":[{"id":"modelId","oid":"modelOid","benchmarkData":{"enableDueDate":true,"isFreeForm":false,"freeFormScript":"","dueDate":{"dataReference":"businessData","dayType":"businessDays","offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},"categories":[{"categoryId":1,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}}]},processDefinitions:[{"id":"process-definition Id","oid":1,"benchmarkData":{"enableDueDate":true,"isFreeForm":false,"freeFormScript":"","dueDate":{"dataReference":"businessData","dayType":"businessDays","offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},"categories":[{"categoryId":1,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}}]},"activities":[{"id":"activityId","oid":3,"benchmarkData":{"enableDueDate":true,"isFreeForm":false,"freeFormScript":"","dueDate":{"dataReference":"businessData","dayType":"businessDays","offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},"categories":[{"categoryId":1,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}}]}}]},{"id":"process-definition Id","oid":2,"benchmarkData":{"enableDueDate":true,"isFreeForm":false,"freeFormScript":"","dueDate":{"dataReference":"businessData","dayType":"businessDays","offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},"categories":[{"categoryId":1,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}}]},"activities":[]}]}]}};
		mockBenchmarks.uuid3 = {"benchmark":{"id":"uuid3","name":"General Processing 3","description":"General Benchmarks","author":"motu","lastModified":"2015-03-12 00:00 | UTC","validFrom":"2015-03-12 00:00 | UTC","categories":[{"id":1,"name":"On Time","color":"#00FF00","range":{"low":0,"high":333}},{"id":3,"name":"Almost Late","color":"#FFFF00","range":{"low":334,"high":666}},{"id":3,"name":"Late","color":"#FF0000","range":{"low":667,"high":1000}}],"models":[{"id":"modelId","oid":"modelOid","benchmarkData":{"enableDueDate":true,"isFreeForm":false,"freeFormScript":"","dueDate":{"dataReference":"businessData","dayType":"businessDays","offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},"categories":[{"categoryId":1,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}}]},processDefinitions:[{"id":"process-definition Id","oid":1,"benchmarkData":{"enableDueDate":true,"isFreeForm":false,"freeFormScript":"","dueDate":{"dataReference":"businessData","dayType":"businessDays","offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},"categories":[{"categoryId":1,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}}]},"activities":[{"id":"activityId","oid":3,"benchmarkData":{"enableDueDate":true,"isFreeForm":false,"freeFormScript":"","dueDate":{"dataReference":"businessData","dayType":"businessDays","offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},"categories":[{"categoryId":1,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}}]}}]},{"id":"process-definition Id","oid":2,"benchmarkData":{"enableDueDate":true,"isFreeForm":false,"freeFormScript":"","dueDate":{"dataReference":"businessData","dayType":"businessDays","offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},"categories":[{"categoryId":1,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}},{"categoryId":2,"condition":{"lhs":"Current Time","operator":"NotLaterThan","rhs":"Business Date"},"useBusinessDays":"true","applyOffset":true,"offset":{"amount":10,"unit":"d","offsetTime":"12:01 AM"}}]},"activities":[]}]}]}};
		
		if(mockBenchmarks[id]){
			deferred.resolve(mockBenchmarks[id])
		}
		else{
			deferred.reject(id)
		}
		
		return deferred.promise;
	}
	
	/**
	 * Returns the basic information for all benchmarks without the 
	 * information regarding associated models,processes,and activities.
	 */
	benchmarkService.prototype.getBenchmarkStubs = function(){
		var deferred = this.$q.defer();
		
		//TODO: remove mock data and pull from server.
		var stubs = [{"benchmark":{"id":"uuid1","name":"General Processing 1","description":"General Benchmarks","author":"motu","lastModified":"2015-03-12 00:00 | UTC","validFrom":"2015-03-12 00:00 | UTC"}},
		             {"benchmark":{"id":"uuid2","name":"General Processing 2","description":"General Benchmarks","author":"motu","lastModified":"2015-03-12 00:00 | UTC","validFrom":"2015-03-12 00:00 | UTC"}},
		             {"benchmark":{"id":"uuid3","name":"General Processing 3","description":"General Benchmarks","author":"motu","lastModified":"2015-03-12 00:00 | UTC","validFrom":"2015-03-12 00:00 | UTC"}}];
		
		deferred.resolve(stubs);
		return deferred.promise;
	}
	
	//our dependencies injected by the Angular DI system.
	benchmarkService.$inject = ["$q", "$http", "$location"];
	
	angular.module("benchmark-app.services")
	.service("benchmarkService",benchmarkService);
	
})();