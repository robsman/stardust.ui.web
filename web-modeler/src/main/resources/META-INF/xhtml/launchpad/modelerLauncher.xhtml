<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
          "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ice="http://www.icesoft.com/icefaces/component"
	xmlns:pc="http://www.sungard.de/carnot/web/portal-plugin/portalcommon">
<head>
<link href="../css/lightdust.css" rel="stylesheet" type="text/css" />
<script type="text/javascript">
	//
	function openViewHandler(modelerLinkId, formId, viewId, viewParams,
			viewIdentity) {
		var form = document.getElementById(formId);
		var link = document.getElementById(modelerLinkId);

		// formOf and iceSubmit are javascript functions provided by icefaces
		var linkForm = formOf(link);

		linkForm[formId + ':_idcl'].value = modelerLinkId;
		linkForm['viewParams'].value = viewParams;
		linkForm['viewId'].value = viewId;
		linkForm['viewIdentity'].value = viewIdentity;
		iceSubmit(linkForm, link);
	}

	function setSelectedModleParams(modelDeployerLinkId, modelFileName,
			modleFilePath, formId) {
		var form = document.getElementById(formId);
		var link = document.getElementById(modelDeployerLinkId);

		// formOf and iceSubmit are javascript functions provided by icefaces

		var linkForm = formOf(link);

		linkForm[formId + ':_idcl'].value = modelDeployerLinkId;
		linkForm['allowBrowse'].value = "false";
		linkForm['fileName'].value = modelFileName;
		linkForm['filePath'].value = modleFilePath;

		iceSubmit(linkForm, link);
	}

	function updateView(modelerLinkId, formId, viewId, viewParams,
			viewIdentity) {
		var form = document.getElementById(formId);
		var link = document.getElementById(modelerLinkId);

		// formOf and iceSubmit are javascript functions provided by icefaces
		var linkForm = formOf(link);

		linkForm[formId + ':_idcl'].value = modelerLinkId;
		linkForm['viewParams'].value = viewParams;
		linkForm['viewId'].value = viewId;
		linkForm['viewIdentity'].value = viewIdentity;
		iceSubmit(linkForm, link);
	}


	function openImportModelDialog(modelerLinkId, formId) {
		var form = document.getElementById(formId);
		var link = document.getElementById(modelerLinkId);

		// formOf and iceSubmit are javascript functions provided by icefaces
		var linkForm = formOf(link);

		linkForm[formId + ':_idcl'].value = modelerLinkId;
		iceSubmit(linkForm, link);
	}

	window.parent.EventHub.events.subscribe("OPEN_VIEW", openViewHandler);
	window.parent.EventHub.events.subscribe("SELECT_MODEL_FOR_DEPLOYMENT",
			setSelectedModleParams);
	window.parent.EventHub.events.subscribe("UPDATE_VIEW", updateView);
	window.parent.EventHub.events.subscribe("OPEN_IMPORT_MODEL_DIALOG", openImportModelDialog);

	function findUserProfileSelect() {
		var userProfileSelect = null;
		var selects = document.getElementsByTagName("select");
		var message = "";

		for ( var i = 0; selects.length > i; i++) {
			var select = selects[i];

			message += select.id + "\n";

			if (select.id.match("userProfileSelect" + "$") == "userProfileSelect") {
				return select;
			}

			return null;
		}
	}

	function changeUserProfile() {
		var userProfileSelect = findUserProfileSelect();

		var selectedProfile = userProfileSelect.options[userProfileSelect.selectedIndex].value;

		window.parent.EventHub.events
				.publish("CHANGE_PROFILE", selectedProfile);
	}
</script>
</head>
<pc:wizard bean="#{modelDeploymentDialogBean}" modal="true" popupX="325"
	popupY="225" />
<body>
	<ice:panelGroup>
		<ui:include src="/plugins/bpm-modeler/popups/modelFileUploadDialog.xhtml">
		</ui:include>
	</ice:panelGroup>
	<ice:panelGroup styleClass="panelHeader">
		<ice:outputText styleClass="panelHeaderTitle" value="Profile" />
	</ice:panelGroup>

	<ice:panelGrid columns="2">
		<ice:outputText value="Select Your Profile" escape="false" />
		<ice:selectOneMenu id="userProfileSelect"
			onchange="changeUserProfile();">
			<f:selectItem itemLabel="Business Analyst"
				itemValue="BusinessAnalyst" />
			<f:selectItem itemLabel="Integrator" itemValue="Integrator" />
		</ice:selectOneMenu>
	</ice:panelGrid>

	<ice:panelGroup styleClass="panelHeader" style="width: 290px;">
		<ice:commandLink action="#{processesView.toggle}">
			<ice:panelGrid columns="2">
				<ice:graphicImage rendered="#{!processesView.expanded}"
					value="/plugins/common/images/panelHeader-triggerExpand.png"
					style="border: none" />
				<ice:graphicImage rendered="#{processesView.expanded}"
					value="/plugins/common/images/panelHeader-triggerCollapse.png"
					style="border: none" />
				<ice:outputText styleClass="panelHeaderTitle"
					value="My Process Models" />
			</ice:panelGrid>
		</ice:commandLink>
	</ice:panelGroup>

	<ice:panelGrid columns="1" rendered="#{processesView.expanded}"
		style="width: 280px;">
		<div id="outlineAnchor" style="width: 280px; height: 580px;"></div>
		<ice:panelGroup style="display: none;">
			<ice:commandLink id="model_view_link"
				action="#{ippPortalApp.openView}" visible="false">
				<f:param name="viewId" value="modelView" />
				<f:param name="viewIdentity" value="REPLACEME" />
				<f:param name="viewParams" value="REPLACEME" />
				<ice:outputText value="Open Model &amp;raquo;"
					styleClass="action-link" escape="false" />
			</ice:commandLink>
			<ice:commandLink id="role_view_link"
				action="#{ippPortalApp.openView}" visible="false">
				<f:param name="viewId" value="roleView" />
				<f:param name="viewIdentity" value="REPLACEME" />
				<f:param name="viewParams" value="REPLACEME" />
				<ice:outputText value="Open Role View &amp;raquo;"
					styleClass="action-link" escape="false" />
			</ice:commandLink>
			<ice:commandLink id="organization_view_link"
				action="#{ippPortalApp.openView}" visible="false">
				<f:param name="viewId" value="organizationView" />
				<f:param name="viewIdentity" value="REPLACEME" />
				<f:param name="viewParams" value="REPLACEME" />
				<ice:outputText value="Open Organization View &amp;raquo;"
					styleClass="action-link" escape="false" />
			</ice:commandLink>
			<ice:commandLink id="data_view_link"
				action="#{ippPortalApp.openView}" visible="false">
				<f:param name="viewId" value="dataView" />
				<f:param name="viewIdentity" value="REPLACEME" />
				<f:param name="viewParams" value="REPLACEME" />
				<ice:outputText value="Open Data View &amp;raquo;"
					styleClass="action-link" escape="false" />
			</ice:commandLink>
			<ice:commandLink id="modeler_view_link"
				action="#{ippPortalApp.openView}" visible="false">
				<f:param name="viewId" value="modelerView" />
				<f:param name="viewIdentity" value="REPLACEME" />
				<f:param name="viewParams" value="REPLACEME" />
				<ice:outputText value="Open Modeler &amp;raquo;"
					styleClass="action-link" escape="false" />
			</ice:commandLink>
			<ice:commandLink id="webservice_application_view_link"
				action="#{ippPortalApp.openView}" visible="false">
				<f:param name="viewId" value="webServiceApplicationView" />
				<f:param name="viewIdentity" value="REPLACEME" />
				<f:param name="viewParams" value="REPLACEME" />
				<ice:outputText value="Open Web Service Application &amp;raquo;"
					styleClass="action-link" escape="false" />
			</ice:commandLink>
			<ice:commandLink id="ui_mashup_application_view_link"
				action="#{ippPortalApp.openView}" visible="false">
				<f:param name="viewId" value="uiMashupApplicationView" />
				<f:param name="viewIdentity" value="REPLACEME" />
				<f:param name="viewParams" value="REPLACEME" />
				<ice:outputText value="Open UI Mashup Application &amp;raquo;"
					styleClass="action-link" escape="false" />
			</ice:commandLink>
			<ice:commandLink id="xsd_structured_data_type_view_link"
				action="#{ippPortalApp.openView}" visible="false">
				<f:param name="viewId" value="xsdStructuredDataTypeView" />
				<f:param name="viewIdentity" value="REPLACEME" />
				<f:param name="viewParams" value="REPLACEME" />
				<ice:outputText value="Open XSD Structured Data Type &amp;raquo;"
					styleClass="action-link" escape="false" />
			</ice:commandLink>
			<ice:commandLink id="message_transformation_application_view_link"
				action="#{ippPortalApp.openView}" visible="false">
				<f:param name="viewId" value="messageTransformationApplicationView" />
				<f:param name="viewIdentity" value="REPLACEME" />
				<f:param name="viewParams" value="REPLACEME" />
				<ice:outputText
					value="Open Message Transformation Application &amp;raquo;"
					styleClass="action-link" escape="false" />
			</ice:commandLink>
			<ice:commandLink id="camel_application_view_link"
				action="#{ippPortalApp.openView}" visible="false">
				<f:param name="viewId" value="camelApplicationView" />
				<f:param name="viewIdentity" value="REPLACEME" />
				<f:param name="viewParams" value="REPLACEME" />
				<ice:outputText value="Open Camel Application &amp;raquo;"
					styleClass="action-link" escape="false" />
			</ice:commandLink>
			<ice:commandLink id="generic_application_view_link"
				action="#{ippPortalApp.openView}" visible="false">
				<f:param name="viewId" value="genericApplicationView" />
				<f:param name="viewIdentity" value="REPLACEME" />
				<f:param name="viewParams" value="REPLACEME" />
				<ice:outputText value="Open Generic Application &amp;raquo;"
					styleClass="action-link" escape="false" />
			</ice:commandLink>
			<ice:commandLink id="modeling_work_assignment_view_link"
				action="#{ippPortalApp.openView}" visible="false">
				<f:param name="viewId" value="modelingWorkAssignmentView" />
				<f:param name="viewIdentity" value="REPLACEME" />
				<f:param name="viewParams" value="REPLACEME" />
				<ice:outputText value="Open Modeling Work Assignment &amp;raquo;"
					styleClass="action-link" escape="false" />
			</ice:commandLink>
			<ice:commandLink id="model_deployer_link"
				actionListener="#{modelDeploymentDialogBean.openDeployModelDialog}"
				style="vertical-align: middle;padding-left: 3px;" visible="false">
				<f:param name="allowBrowse" />
				<f:param name="fileName" />
				<f:param name="filePath" />
				<ice:outputText
					style="color: #00629A; font-family: Arial,Helvetica,sans-serif;"
					value="Deploy Model" />
			</ice:commandLink>
			<ice:commandLink id="view_updater_link"
				action="#{jsfViewUpdaterBean.updateView}" visible="false">
				<f:param name="viewId" value="REPLACEME" />
				<f:param name="viewIdentity" value="REPLACEME" />
				<f:param name="viewParams" value="REPLACEME" />
				<ice:outputText value="Update view &amp;raquo;"
					styleClass="action-link" escape="false" />
			</ice:commandLink>
			<ice:commandLink id="open_model_upload_dialog_link"
				action="#{modelFileUploadDialog.openPopup}">
				<ice:outputText value="Open upload model dialog &amp;raquo;"
					styleClass="action-link" escape="false" />
			</ice:commandLink>
		</ice:panelGroup>
		<ice:panelGroup styleClass="clearing" />
	</ice:panelGrid>

	<ice:panelGroup styleClass="panelHeader" style="width: 290px;">
		<ice:commandLink action="#{sessionLogPanel.toggle}">
			<ice:panelGrid columns="2">
				<ice:graphicImage rendered="#{!sessionLogPanel.expanded}"
					value="/plugins/common/images/panelHeader-triggerExpand.png"
					style="border: none" />
				<ice:graphicImage rendered="#{sessionLogPanel.expanded}"
					value="/plugins/common/images/panelHeader-triggerCollapse.png"
					style="border: none" />
				<ice:outputText styleClass="panelHeaderTitle"
					value="My Modeling Session" />
			</ice:panelGrid>
		</ice:commandLink>
	</ice:panelGroup>

	<ice:panelGrid columns="1" rendered="#{sessionLogPanel.expanded}"
		style="width: 280px;">
		<ice:panelGroup>
			<ice:commandLink action="#{inviteParticipantsDialog.openPopup}">
				<ice:graphicImage
					value="/plugins/views-common/images/icons/user_add.png"
					style="border: none" />
			</ice:commandLink>
		</ice:panelGroup>
		<div id="sessionLogPanelAnchor" style="width: 280px; height: 450px;"></div>
		<ice:panelGroup styleClass="clearing" />
	</ice:panelGrid>

	<ice:panelPopup id="inviteParticipantsDialog" draggable="true"
		modal="true" visible="#{inviteParticipantsDialog.visible}"
		styleClass="dialog">
		<f:facet name="header">
			<ice:panelGroup styleClass="dialog-header">
				<ice:outputText value="Invite Participants" />
			</ice:panelGroup>
		</f:facet>
		<f:facet name="body">
			<ice:panelGroup styleClass="dialog-body">
				<ice:panelGrid columns="1" cellpadding="0" cellspacing="0"
					columnClasses="center-aligned-column">
					<ice:panelGrid columns="1" cellpadding="0" cellspacing="0">
						<ice:panelGrid columns="2" cellpadding="0" cellspacing="0">
							<ice:outputLabel for="filterStringInput" value="Filter" />
							<ice:inputText id="filterStringInput"
								value="#{inviteParticipantsDialog.filterString}" />
						</ice:panelGrid>
						<ice:panelGrid columns="1" cellpadding="0" cellspacing="0">
							<ice:outputLabel for="participantListbox" value="Participant" />
							<ice:selectManyListbox id="participantListbox"
								valueChangeListener="#{inviteParticipantsDialog.userChanged}"
								partialSubmit="true" size="5" style="margin-top: 5px;">
								<f:selectItems
									value="#{inviteParticipantsDialog.notInvitedUsers}" />
							</ice:selectManyListbox>
						</ice:panelGrid>
						<ice:panelGrid columns="2" cellpadding="0" cellspacing="0"
							style="margin-top: 10px;">
							<ice:selectBooleanCheckbox id="notifyViaEmailCheckbox"
								value="#{inviteParticipantsDialog.notifyViaEmail}" />
							<ice:outputLabel for="notifyViaEmailCheckbox"
								value="Notify via E-Mail" />
							<ice:selectBooleanCheckbox id="notifyViaAlertCheckbox"
								value="#{inviteParticipantsDialog.notifyViaAlert}" />
							<ice:outputLabel for="notifyViaAlertCheckbox"
								value="Notify via Portal Alert" />
						</ice:panelGrid>
					</ice:panelGrid>
					<ice:panelGrid columns="2" cellpadding="0" cellspacing="0"
						styleClass="button-grid" style="margin-top: 10px;">
						<ice:commandButton type="submit"
							action="#{inviteParticipantsDialog.inviteParticipants}"
							value="Invite" style="margin-right: 10px;" />
						<ice:commandButton type="submit"
							action="#{inviteParticipantsDialog.closePopup}" value="Cancel" />
					</ice:panelGrid>
				</ice:panelGrid>
			</ice:panelGroup>
		</f:facet>
	</ice:panelPopup>
</body>
</html>