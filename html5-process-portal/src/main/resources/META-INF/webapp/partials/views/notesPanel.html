<div class="view-panel" ng-controller="sdNotesCtrl as ctrl"
	sg-stretch-to-bottom>
	<div class="view-panel-toolbar heading">{{i18n('processportal.views-notesPanel-title')}}</div>
	<div sda-toolbar>
		<div class="tbl-toolbar-section">
			<button ng-disabled="ctrl.isAddMode"
				ng-click="bpmCommon.stopEvent($event); ctrl.addNote();"
				title="{{i18n('processportal.views-notesPanel-button-addNote')}}"
				class="button-link tbl-toolbar-item tbl-tool-link"
				aid="PP-NotesView-AddNote">
				<i class="sc sc-fw sc-1x sc-document"></i>
			</button>
		</div>
	</div>
	<table sd-data-table="ctrl.notesTable"
		sd-data="ctrl.getNotesData(params)" sda-mode="local"
		sda-ready="ctrl.showNotesTable" sda-selectable="row"
		sda-selection="ctrl.rowSelectionNotesTable"
		sda-initial-selection="[{noteNumber: ctrl.notes.totalCount}]"
		sda-on-select="ctrl.onSelect(info)"
		sda-column-selector="{{ctrl.columnSelector}}" sda-sortable="true"
		sda-sort-by="{name : 'teamMember', dir : 'desc'}" sda-exports="false"
		sda-preference-module="ipp-workflow-perspective" sda-preference-id="preference"
		sda-preference-name="ipp-workflow-perspective.processportalNotesTable.selectedColumns">
		<thead sda-i18n-scope="processportal.views-notesPanel-column">
			<tr>
				<th sda-name="noteNumber" sda-sortable="true"></th>
				<th sda-name="creatorName" sda-label-key="createdBy"></th>
				<th sda-name="created" sda-label-key="creationTime"
					sda-sortable="true"></th>
				<th sda-name="note" sda-label-key="preview"></th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td sda-data-type="int"></td>
				<td sda-exporter="rowData.creatorName" style="text-align: center;">
					<img alt=""
					ng-src="{{ctrl.getUserImageURL(rowData.avatarImageURI)}}"
					width="24px" height="24px" style="padding-right: 5px;">{{rowData.creatorName}}
				</td>
				<td sda-data-type="dateTime"></td>
				<td><table>
						<tbody>
							<tr style="vertical-align: top;">
								<td><i class="sc sc-fw sc-1x sc-document"></i></td>
								<td><div sd-tool-tip
										sda-tool-tip-url="'plugins/html5-process-portal/partials/views/notePreviewToolTip.html'"
										sda-title="rowData.note"></div>
								</td>
							</tr>
						</tbody>
					</table></td>
			</tr>
		</tbody>
	</table>

	<div>
		<div style="padding-bottom: 5px;"
			ng-if="!ctrl.isAddMode && ctrl.rowSelectionNotesTable">
			<table>
				<tr>
					<td><img alt=""
						ng-src="{{ctrl.getUserImageURL(ctrl.rowSelectionNotesTable.avatarImageURI)}}"
						width="24px" height="24px" style="padding-right: 5px;"></td>
					<td><sd-user-details
							sda-user-oid="ctrl.rowSelectionNotesTable.userOID"
							sda-account="ctrl.rowSelectionNotesTable.creatorName"
							sda-aid-prefix="PP-NotesView-UserDetails"></sd-user-details></td>
					<td>added note #{{ctrl.rowSelectionNotesTable.noteNumber}} -
						{{ctrl.rowSelectionNotesTable.created | sdDateTimeFilter}}</td>
				</tr>
			</table>
		</div>
		<textarea ng-if="ctrl.notes.totalCount > 0 || ctrl.isAddMode"
			ng-disabled="!ctrl.isAddMode" ng-model="ctrl.note" cols="20" rows="2"
			style="height: 300px; width: 99%; background-color: rgb(247, 246, 178);" aid="PP-NotesView-NoteText"></textarea>
		<div ng-if="ctrl.isAddMode">
			<table>
				<tr>
					<td><a href="#" style="font-weight: bold;"
						ng-click="ctrl.saveNote()" aid="PP-NotesView-SaveNote">
							<table>
								<tbody>
									<tr>
										<td><i class="sc sc-fw sc-1x sc-cloud-d"></i></td>
										<td><span>{{i18n('processportal.views-notesPanel-button-save')}}</span></td>
									</tr>
								</tbody>
							</table>
					</a></td>
					<td><a href="#" style="font-weight: bold;"
						ng-click="ctrl.cancelNote()" aid="PP-NotesView-CancelNote">
							<table>
								<tbody>
									<tr>
										<td><i class="sc sc-fw sc-1x sc-close"
											style="color: red;"></i></td>
										<td><span>{{i18n('processportal.views-notesPanel-button-cancel')}}</span></td>
									</tr>
								</tbody>
							</table>
					</a></td>
				</tr>
			</table>
		</div>
	</div>
</div>