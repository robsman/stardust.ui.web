<div class="worklist-wrapper">
	<div class="worklist-title tbl-title">{{worklistCtrl.title}}</div>
	<div sda-toolbar>
		<div class="tbl-toolbar-section">
			<button sda-column="TRIVIAL_DATA" ng-disabled="!worklistCtrl.containsAllTrivialManualActivities()" ng-click="worklistCtrl.$openCompleteDialog()" title="{{i18n('processportal.views-worklistPanel-tooltip-completeAll')}}" class="button-link tbl-toolbar-item tbl-tool-link">
			   <i class="glyphicon glyphicon-share-alt"></i>
			</button>
			<button ng-disabled="worklistCtrl.dataTable.getSelection() < 1" href="#" ng-click="worklistCtrl.$openDelegateDialog();" title="{{i18n('processportal.toolbars-worklistView-tooltip-delegate')}}" class="button-link tbl-toolbar-item tbl-tool-link" >
			   <i class="glyphicon glyphicon-user"></i>
			</button>
			<button ng-disabled="worklistCtrl.dataTable.getSelection() < 1" ng-click="worklistCtrl.$openAbortDialog(worklistCtrl.dataTable.getSelection())" title="{{i18n('processportal.toolbars-worklistView-tooltip-abort')}}" class="button-link tbl-toolbar-item tbl-tool-link" style="margin-right: 0px;">
			   <i class="glyphicon glyphicon-remove"></i>
			</button>
			<button sd-abort-popover ng-disabled="worklistCtrl.dataTable.getSelection() < 1" sda-activities="worklistCtrl.dataTable.getSelection()" sda-on-confirm="worklistCtrl.refresh()" class="button-link tbl-toolbar-item tbl-tool-link" style="padding-left: 0px;">
				<i class="glyphicon glyphicon-chevron-right glyphicon-rotate-90"></i>
			</button>
			<!-- <div sd-abort-popover sda-show-popover="worklistCtrl.showAbortPopover">
			</div> -->
		</div>
	</div>
	<table sd-data-table="{{worklistCtrl.tableHandleExpr}}" sd-data="worklistCtrl.fetchPage(params)" sda-ready="worklistCtrl.ready"
		sda-page-size="{{worklistCtrl.sdaPageSize}}" sda-mode="remote"
		sda-selectable="multiple" sda-initial-selection="{{worklistCtrl.initialSelection}}" sda-selection="{{worklistCtrl.selectionExpr}}"
		sda-on-select="worklistCtrl.onSelect(info)" sda-on-pagination="worklistCtrl.onPagination(info)"
		sda-column-selector="{{worklistCtrl.columnSelector}}" sda-preference-delegate="worklistCtrl.preferenceDelegate(prefInfo)"
		sda-on-column-reorder="worklistCtrl.onColumnReorder(info)"
		sda-sortable="true" sda-sort-by="{name : 'started', dir : 'desc'}" sda-on-sorting="worklistCtrl.onSorting(info)"
		sda-exports="Excel,CSV">
		<thead sda-i18n-scope="processportal.views-worklistPanel-column">
			<tr>
				<th sda-name="overview" sda-sortable="true">
					<div sda-filter-template>
						<div sd-process-activity-filter sda-filter-type='activity' sda-processes="worklistCtrl.allAccessibleProcesses"></div>
					</div>
				</th>
				<th sda-name="oid" sda-sortable="true" sda-filterable="true"
					sda-exportable=""></th>
				<th sda-name="criticality" sda-sortable="true">
					<div sda-filter-template>
						<div sd-criticality-filter sda-criticalities="worklistCtrl.allAvailableCriticalities"></div>
					</div>
				</th>
				<th sda-name="priority" sda-sortable="true">
					<div sda-filter-template>
						<div sd-priority-filter></div>
					</div>
				</th>
				<th sda-name="descriptors" sda-visible="true"></th>
				<th sda-name="started" sda-sortable="true" sda-filterable="true"></th>
				<th sda-name="lastModified" sda-label-key="lastmodification"
					sda-sortable="true" sda-filterable="true"></th>
				<th sda-name="duration" sda-sortable="false"></th>
				<th sda-name="lastPerformer" sda-sortable="false"></th>
				<th sda-name="processDefinition" sda-label-key="processName"
					sda-visible="false" sda-sortable="false">
					<div sda-filter-template>
						<div sd-process-activity-filter sda-filter-type='process' sda-processes="worklistCtrl.allAccessibleProcesses"></div>
					</div>
				</th>
				<th sda-name="status" sda-sortable="false" sda-visible="false">
					<div sda-filter-template>
						<div sd-multi-select-filter sda-options="worklistCtrl.availableStates"></div>
					</div>
				</th>
				<th sda-name="assignedTo" sda-sortable="false" sda-visible="false"></th>
				<th ng-repeat="descCol in worklistCtrl.descritorCols"
					sda-name="{{descCol.id}}" sda-label="{{descCol.title}}"
					sda-visible="false" sda-sortable="{{descCol.sortable}}">
					<div sda-filter-template ng-if="descCol.filterable">
						<div ng-if="colData.dataType =='NUMBER'"><div sd-number-filter></div></div>
						<div ng-if="colData.dataType =='DATE'"><div sd-date-filter></div></div>
						<div ng-if="colData.dataType =='BOOLEAN'"><div sd-boolean-filter></div></div>
						<div ng-if="colData.dataType =='STRING'"><div sd-text-search-filter></div></div>
					</div>

				</th>
				<th sda-name="data" sda-column="TRIVIAL_DATA" sda-sortable="false"></th>
				<th sda-name="actions" sda-fixed="true"></th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td style="white-space: nowrap;">
					<a  ng-if="rowData.activatable" href="#" ng-click="bpmCommon.stopEvent($event); worklistCtrl.$activateWorkItem(rowData);">
						{{rowData.activity.name}}
					</a>
					<span ng-if="!rowData.activatable" ng-bind="rowData.activity.name"> </span>
					<span ng-if="rowData.qualityAssuranceState">
						<span ng-if="rowData.qualityAssuranceState ==='IS_REVISED'"> <i class="glyphicon glyphicon-remove-circle" style="color:red;margin-left:2px;"></i></span>
						<span ng-if="rowData.qualityAssuranceState === 'IS_QUALITY_ASSURANCE'"><i class="glyphicon glyphicon-time" style="margin-left:2px;"></i></span>
					</span>
				</td>
				<td sda-data-type="int" style="text-align: center;"></td>
				<td style="text-align: center;"><div sd-activity-criticality sda-criticality="rowData.criticality"></div></td>
				<td style="text-align: center;"><div sd-process-priority sda-priority="rowData.priority"></div></td>
				<td>
					<table>
						<tr ng-repeat="desc in rowData.descriptors">
							<td style="white-space: nowrap;">{{desc.key}}</td>
							<td style="white-space: nowrap;">{{desc.value}}</td>
						</tr>
					</table>
					<div sd-editor-template></div>
				</td>
				<td sda-field="start" sda-data-type="dateTime" style="text-align: center; white-space: nowrap;"></td>
				<td sda-field="lastModification" sda-data-type="dateTime" style="text-align: center; white-space: nowrap;"></td>
				<td sda-field="duration"></td>
				<td sda-field="lastPerformer" ></td>
				<td sda-field="processInstance.processName"></td>
				<td sda-field="status.label" ></td>
				<td sda-field="assignedTo"></td>
				<td ng-repeat="descCol in worklistCtrl.descritorCols"
					sda-field="{{descCol.field}}" sda-data-type="{{descCol.dataType}}" style="white-space: nowrap;">
				</td>
				<td sda-column="TRIVIAL_DATA">
				 <div data-ng-include="'plugins/html5-process-portal/scripts/directives/partials/worklistData.html'">
				</td>
				<td>
					<div style="text-align: right; white-space: nowrap;">
						<button ng-click="bpmCommon.stopEvent($event); worklistCtrl.$openNotes(rowData);"
							title="{{i18n('processportal.toolbars-workflowActions-tooltip-notes')}}" class="button-link tbl-tool-link">
							<i class="glyphicon glyphicon-comment"></i>
						</button>
						<button ng-click="bpmCommon.stopEvent($event); worklistCtrl.$openProcessHistory(rowData);"
							title="{{i18n('processportal.toolbars-workflowActions-tooltip-processHistory')}}" class="button-link tbl-tool-link">
							<i class="glyphicon glyphicon-tasks"></i>
						</button>
						<button sda-column="TRIVIAL_DATA"
							ng-disabled="worklistCtrl.worklist.trivialManualActivities[rowData.oid] == undefined"
							ng-click="bpmCommon.stopEvent($event); worklistCtrl.$openCompleteDialog(rowData);"
							title="{{i18n('processportal.toolbars-workflowActions-tooltip-complete')}}" class="button-link tbl-tool-link">
							<i class="glyphicon glyphicon-share-alt"></i>
						</button>
						<button ng-click="bpmCommon.stopEvent($event); worklistCtrl.$openDelegateDialog(rowData);" ng-disabled="!rowData.delegable || row.defaultCaseActivity"
							title="{{i18n('processportal.toolbars-workflowActions-tooltip-delegate')}}" class="button-link tbl-tool-link">
							<i class="glyphicon glyphicon-user"></i>
						</button>
						<button ng-click="bpmCommon.stopEvent($event); worklistCtrl.$openAbortDialog(rowData);" ng-disabled="!rowData.abortActivity || row.defaultCaseActivity"
							title="{{i18n('processportal.toolbars-workflowActions-tooltip-abort')}}" class="button-link tbl-tool-link">
							<i class="glyphicon glyphicon-remove"></i>
						</button>
					</div>
				</td>
			</tr>
		</tbody>
	</table>

	<div sd-dialog 
		sda-show="worklistCtrl.showCompleteDialog"
		sda-type="confirm" sda-title="{{i18n('processportal.views-completeActivityDialog-title')}}"
		sda-scope="this" sda-on-open="worklistCtrl.$completeAll(res)"
		sda-template="plugins/html5-process-portal/scripts/directives/partials/completeActivityDialog.html">
	</div>

	<div sd-dialog
		sda-show="worklistCtrl.showCompleteNotificationDialog"
		sda-type="custom" sda-title="{{i18n('admin-portal-messages.common-notification-title')}}"
		sda-scope="this" 
		sda-template="plugins/html5-process-portal/scripts/directives/partials/completeActivityNotfication.html">
	</div>

	<span sd-delegate-activity-dialog sda-show-dialog="worklistCtrl.showDelegateDialog" sda-activity-list="worklistCtrl.selectedActivity"
		sda-on-confirm="worklistCtrl.onDelegateConfirm()">
	</span>

	<!--Dialog for abort Activity  -->
	<div sd-abort-activity-dialog sda-show-dialog="worklistCtrl.showAbortActivityDialog" sda-on-abort-complete="worklistCtrl.abortCompleted()" sda-activities-to-abort="worklistCtrl.activitiesToAbort" ></div>
</div>
