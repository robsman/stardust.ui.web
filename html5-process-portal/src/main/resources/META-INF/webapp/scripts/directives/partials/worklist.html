<div class="worklist-wrapper">
	<div class="worklist-title tbl-title">{{worklistCtrl.title}}</div>
	<div sda-toolbar>
		<button sda-column="TRIVIAL_DATA" ng-click="worklistCtrl.$completeAll()" title="Complete All" class="button-link tbl-toolbar-item tbl-tool-link">
		   <i class="fa fa-share"></i>
		</button>
		<button ng-disabled="worklistCtrl.dataTable.getSelection() < 1" ng-click="worklistCtrl.$openDelegateDialog();" title="Delegate" class="button-link tbl-toolbar-item tbl-tool-link" >
		   <i class="fa fa-user"></i>
		</button>
		<button ng-disabled="worklistCtrl.dataTable.getSelection() < 1" ng-click="worklistCtrl.$openAbortDialog(worklistCtrl.dataTable.getSelection())" title="Abort Activity" class="button-link tbl-toolbar-item tbl-tool-link">
		   <i class="fa fa-remove"></i>
		</button>
	</div>
	<table sd-data-table="{{worklistCtrl.tableHandleExpr}}" sd-data="worklistCtrl.fetchPage(params)" sda-ready="worklistCtrl.ready"
		sda-page-size="{{worklistCtrl.sdaPageSize}}" sda-mode="remote"
		sda-selectable="multiple" sda-initial-selection="{{worklistCtrl.initialSelection}}" sda-selection="{{worklistCtrl.selectionExpr}}"
		sda-on-select="worklistCtrl.onSelect(info)" sda-on-pagination="worklistCtrl.onPagination(info)"
		sda-column-selector="{{worklistCtrl.columnSelector}}" sda-preference-delegate="worklistCtrl.preferenceDelegate(prefInfo)"
		sda-on-column-reorder="worklistCtrl.onColumnReorder(info)"
		sda-sortable="true" sda-sort-by="{name : 'started', dir : 'desc'}" sda-on-sorting="worklistCtrl.onSorting(info)">
		<thead sda-i18n-scope="processportal.views-worklistPanel-column">
			<tr>
				<th sda-name="overview" sda-sortable="true">
					<div sda-filter-template>
						<div sd-process-activity-filter type='activity'></div>
					</div>
				</th>
				<th sda-name="oid" sda-sortable="true" sda-filterable="true"
					sda-exportable=""></th>
				<th sda-name="criticality" sda-sortable="true">
					<div sda-filter-template>
						<div sd-criticality-filter sda-selected-criticalities="filterData"></div>
					</div>
				</th>
				<th sda-name="priority" sda-sortable="true">
					<div sda-filter-template>
						<div sd-priority-filter></div>
					</div>
				</th>
				<th sda-name="descriptors" sda-visible="true"></th>
				<th sda-name="started" sda-sortable="true" sda-filterable="true"></th>
				<th sda-name="lastModified" sda-label-key="lastmodification"
					sda-sortable="true" sda-filterable="true"></th>
				<th sda-name="duration" sda-sortable="false"></th>
				<th sda-name="lastPerformer" sda-sortable="false"></th>
				<th sda-name="processDefinition" sda-label-key="processName"
					sda-visible="false">
					<div sda-filter-template>
						<div sd-process-activity-filter sda-filter-type='process'
							sda-processes='worklistCtrl.allAccessibleProcesses'
							sda-selected-values="filterData"></div>
					</div>
				</th>
				<th sda-name="status" sda-sortable="false" sda-visible="false">
					<div sda-filter-template>
						<div sd-status-filter></div>
					</div>
				</th>
				<th sda-name="assignedTo" sda-sortable="false" sda-visible="false"></th>
				<th ng-repeat="descCol in worklistCtrl.descritorCols"
					sda-name="{{descCol.id}}" sda-label="{{descCol.title}}"
					sda-visible="false" sda-sortable="{{descCol.sortable}}">
					<div sda-filter-template>
						<div sd-text-search-filter></div>
					</div>
				</th>
				<th sda-name="data" sda-column="TRIVIAL_DATA" sda-sortable="false"></th>
				<th sda-name="actions" sda-fixed="true"></th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td style="white-space: nowrap;">
					<a href="#" ng-click="bpmCommon.stopEvent($event); worklistCtrl.$activateWorkItem(rowData);">
						{{rowData.activity.name}}
					</a>
				</td>
				<td sda-data-type="int" style="text-align: center;"></td>
				<td style="text-align: center;"><div sd-activity-criticality></div></td>
				<td style="text-align: center;"><div sd-process-priority></div></td>
				<td>
					<table>
						<tr ng-repeat="desc in rowData.descriptors">
							<td style="white-space: nowrap;">{{desc.key}}</td>
							<td style="white-space: nowrap;">{{desc.value}}</td>
						</tr>
					</table>
					<div sd-editor-template></div>
				</td>
				<td sda-field="start" sda-data-type="dateTime" style="text-align: center; white-space: nowrap;"></td>
				<td sda-field="lastModification" sda-data-type="dateTime" style="text-align: center; white-space: nowrap;"></td>
				<td sda-field="duration"></td>
				<td sda-field="lastPerformer" ></td>
				<td sda-field="processInstance.processName"></td>
				<td sda-field="status.label" ></td>
				<td sda-field="assignedTo"></td>
				<td ng-repeat="descCol in worklistCtrl.descritorCols"
					sda-field="{{descCol.field}}" sda-data-type="{{descCol.dataType}}" style="white-space: nowrap;">
				</td>
				<td sda-column="TRIVIAL_DATA">
					<table ng-hide="!worklistCtrl.worklist.trivialManualActivities[rowData.oid]">
						<tbody>
					    	<tr ng-repeat="mapping in worklistCtrl.worklist.trivialManualActivities[rowData.oid].dataMappings">
					        	<td style="white-space: nowrap;">{{mapping.name}}</td>
					            <td>
					            	<select ng-show="mapping.isEnum" ng-click="bpmCommon.stopEvent($event)"
					      		    	ng-model="worklistCtrl.worklist.trivialManualActivities[rowData.oid].inOutData[mapping.id]"
					                    ng-init="worklistCtrl.worklist.trivialManualActivities[rowData.oid].inOutData[mapping.id] = worklistCtrl.worklist.trivialManualActivities[rowData.oid].inOutData[mapping.id] || mapping.enumValues[0]"
					                    ng-options="enumVal for enumVal in mapping.enumValues">
									</select>

									<input type="text" ng-click="bpmCommon.stopEvent($event)"
					                	ng-show="mapping.typeName == 'java.lang.String'"
					                    ng-model="worklistCtrl.worklist.trivialManualActivities[rowData.oid].inOutData[mapping.id]" />

									<input type="checkbox" ng-click="bpmCommon.stopEvent($event)"
										ng-show="mapping.typeName == 'java.lang.Boolean'"
										ng-model="worklistCtrl.worklist.trivialManualActivities[rowData.oid].inOutData[mapping.id]" />
								</td>
							</tr>
						</tbody>
					</table>
				</td>
				<td style="white-space: nowrap; text-align: right;">
					<button ng-click="bpmCommon.stopEvent($event); worklistCtrl.$openNotes(rowData);"
						title="Open Notes" class="button-link view-tool-link">
						<i class="fa fa-comment-o"></i>
					</button>
					<button ng-click="bpmCommon.stopEvent($event); worklistCtrl.$openProcessHistory(rowData);"
						title="Process History" class="button-link view-tool-link">
						<i class="fa fa-tasks"></i>
					</button>
					<button sda-column="TRIVIAL_DATA"
						ng-disabled="!worklistCtrl.worklist.trivialManualActivities[rowData.oid]"
						ng-click="bpmCommon.stopEvent($event); worklistCtrl.$complete(rowData);"
						title="Complete" class="button-link view-tool-link">
						<i class="fa fa-share"></i>
					</button>
					<button ng-click="bpmCommon.stopEvent($event); worklistCtrl.$openDelegateDialog(rowData);"
						title="Delegate" class="button-link view-tool-link">
						<i class="fa fa-user"></i>
					</button>
					<button ng-click="bpmCommon.stopEvent($event); worklistCtrl.$openAbortDialog(rowData);"
						title="Abort" class="button-link view-tool-link">
						<i class="fa fa-remove"></i>
					</button>
				</td>
			</tr>
		</tbody>
	</table>

	<span sd-delegate-activity-dialog sda-show-dialog="worklistCtrl.showDelegateDialog" sda-activity-list="worklistCtrl.selectedActivity"
		sda-on-confirm="worklistCtrl.onDelegateConfirm()">
	</span>

	<!--Dialog for abort Activity  -->
	<div sd-abort-activity-dialog sda-show-dialog="worklistCtrl.showAbortActivityDialog" sda-on-abort-complete="worklistCtrl.abortCompleted()" sda-activities-to-abort="worklistCtrl.activitiesToAbort" ></div>
</div>
