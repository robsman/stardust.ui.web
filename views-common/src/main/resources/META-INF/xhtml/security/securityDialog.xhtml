<f:view xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ice="http://www.icesoft.com/icefaces/component"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:pc="http://www.sungard.de/carnot/web/portal-plugin/portalcommon"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions">
	<ice:panelPopup id="#{securityDialog.beanId}" modal="true" rendered="#{securityDialog.visible}"
		draggable="true"
		styleClass="popupDialog" autoPosition="manual" clientOnly="true">
		<f:facet name="header">
			<ice:panelGroup>
				<pc:automationTag value="auto-COM-SecurityDlg-Header"/>
				<ice:outputText
					value="#{securityDialog.messages['securityDialog.title']}"
					escape="false" styleClass="headerText" />
				<ice:commandButton
					image="/plugins/views-common/images/icons/dialog-windowbttn-close.png" title="#{common_msgPropsBean['common.close']}"
					styleClass="windowClose" action="#{securityDialog.closePopup}" />
			</ice:panelGroup>
		</f:facet>
		<f:facet name="body">
			<ice:panelBorder styleClass="pnlPopUpBrdrDialog" cellpadding="0"
				cellspacing="0" renderNorth="false" renderEast="false"
				renderSouth="true" renderWest="false" renderCenter="true">
				<f:facet name="center">
					<ice:panelGroup>
						<ice:panelGroup styleClass="panelHeader">
							<ice:commandLink
								action="#{securityDialog.toggleExpandCollpase}">
								<ice:panelGrid columns="2">
									<ice:graphicImage rendered="#{!securityDialog.expanded}"
										value="/plugins/views-common/images/icons/thumbnailsPanel-triggerExpand.png"
										style="border: none" />
									<ice:graphicImage rendered="#{securityDialog.expanded}"
										value="/plugins/views-common/images/icons/panelHeader-triggerCollapse.png"
										style="border: none" />
									<ice:outputText styleClass="panelHeaderTitle"
										value="#{securityDialog.messages['securityDialog.inheritedTable.title']}  #{securityDialog.resourceName}" />
								</ice:panelGrid>
							</ice:commandLink>
						</ice:panelGroup>
						<ice:panelGroup rendered="#{securityDialog.expanded}">
							<pc:automationTag value="auto-COM-SecurityDlg-InheritedTbl" />
							<pc:genericDataTable
								exportExcel="false" exportCsv="false" 
								bean="#{securityDialog}" id="ctxSecurityDialogInherited"
								table="#{securityDialog.securityDialogInheritedTable}"
								sortSupported="true" />
						</ice:panelGroup>
						<ice:panelGroup>
							<pc:automationTag value="auto-COM-SecurityDlg-SecurityDlgTbl" />
							<pc:genericDataTable
								title="#{securityDialog.messages['securityDialog.table.title']} #{securityDialog.resourceName}"
								exportExcel="false" exportCsv="false"
								bean="#{securityDialog}" id="ctxSecurityDialog"
								table="#{securityDialog.securityDialogTable}"
								toolbarUrl="/plugins/views-common/extension/toolbar/securityDialogToolbar.xhtml"
								sortSupported="true" />
						</ice:panelGroup>
					</ice:panelGroup>
				</f:facet>
				<f:facet name="south">
					<ice:panelGroup>
						<ice:panelGrid columns="3" style="float:right;">
							<pc:automationTag value="auto-COM-SecurityDlg-BtnsBar" standAlone="false"/>
							<ice:commandButton rendered="#{securityDialog.editMode}" 
								value="#{securityDialog.messages['securityDialog.button.apply']}"
								styleClass="button" action="#{securityDialog.apply}" />
							<ice:commandButton
								value="#{views_common_msgPropsBean['common.close']}"
								styleClass="button" action="#{securityDialog.closePopup}" />
						</ice:panelGrid>
						
					</ice:panelGroup>
				</f:facet>
			</ice:panelBorder>
		</f:facet>
	</ice:panelPopup>

	<ice:panelPopup id="#{securityDialog.addEntryDialogId}" modal="true"
		rendered="#{securityDialog.openAddEntryDialog}"
		draggable="true"
		styleClass="popupDialog" autoPosition="manual" clientOnly="true">
		<f:facet name="header">
			<ice:panelGroup>
				<pc:automationTag value="auto-COM-SecurityDlg-PartDlg-Header"/>
				<ice:outputText
					value="#{securityDialog.messages['securityDialog.participantPopup.title']}"
					escape="false" styleClass="headerText" />
				<ice:commandButton
					image="/plugins/views-common/images/icons/dialog-windowbttn-close.png"
					action="#{securityDialog.closeAddEntryDialog}" title="#{common_msgPropsBean['common.close']}"
					styleClass="windowClose" />
			</ice:panelGroup>
		</f:facet>
		<f:facet name="body">
			<ice:panelBorder styleClass="pnlPopUpBrdrDialog" cellpadding="0"
				cellspacing="0" renderNorth="false" renderEast="false"
				renderSouth="true" renderWest="false" renderCenter="true">
				<f:facet name="center">					
					<ice:panelGroup style="width : 740px; height: 350px;">
						<ice:panelGroup rendered="#{securityDialog.pickFromListMode}">
							<ice:panelGrid style="width: 98%">
								<ice:commandLink action="#{securityDialog.setPickFromTreeMode}"
									style="float : right">
									<pc:automationTag value="auto-COM-SecurityDlg-PickFromTreeLink"
										standAlone="false" />
									<ice:outputText
										value="#{views_common_msgPropsBean['delegation.tree.link.text']} &amp;raquo;"
										styleClass="action-link" escape="false" />
								</ice:commandLink>
							</ice:panelGrid>
							<ice:panelGroup style="clearing" />
							<ice:panelGroup
								style="width:100%;height: 230px; overflow: scroll; background-color:white;">
								<ice:dataTable var="entry" value="#{securityDialog.participants}"
									resizable="true" columnWidths="60%,40%" border="0">
									<ice:column>
										<ice:rowSelector value="#{entry.selected}"
											clickAction="dummyAction"
											selectionListener="#{securityDialog.onRowSelection}" />
										<f:facet name="header">
											<ice:outputText
												value="#{securityDialog.messages['securityDialog.participantPopup.column.name']}" />
										</f:facet>
										<ice:panelGrid columns="2">
											<ice:outputText value="#{entry.name}" />
										</ice:panelGrid>
									</ice:column>
									<ice:column>
										<f:facet name="header">
											<ice:outputText
												value="#{securityDialog.messages['securityDialog.participantPopup.column.id']}" />
										</f:facet>
										<ice:panelGrid columns="2">
											<ice:outputText value="#{entry.id}" />
										</ice:panelGrid>
									</ice:column>
								</ice:dataTable>
							</ice:panelGroup>
						</ice:panelGroup>
						<ice:panelGroup rendered="#{securityDialog.pickFromTreeMode}">
							<ice:panelGrid style="width: 98%">
								<ice:commandLink action="#{securityDialog.setPickFromListMode}"
									style="float : right">
									<pc:automationTag value="auto-COM-SecurityDlg-PickFromListLink"
										standAlone="false" />
									<ice:outputText
										value="#{views_common_msgPropsBean['delegation.select.toggleLinkText']} &amp;raquo;"
										styleClass="action-link" escape="false" />
								</ice:commandLink>
							</ice:panelGrid>
							<ice:panelGroup style="clearing" />
							<ice:panelGroup style="height: 325px; overflow: auto;">
								<ui:include src="/plugins/views-common/participantTree/participantTree.xhtml">
									<ui:param name="participantTree" value="#{securityDialog.participantTree}" />
									<ui:param name="disableContextMenu" value="true" />
									<ui:param name="nodesSelectable" value="true" />
								</ui:include>
							</ice:panelGroup>
						</ice:panelGroup>
					</ice:panelGroup>
				</f:facet>
				<f:facet name="south">
					<ice:panelGroup>
						<ice:panelGrid columns="2">
							<pc:automationTag value="auto-COM-SecurityDlg-PartDlg-BtnsBar" standAlone="false"/>
							<ice:commandButton
								value="#{securityDialog.messages['securityDialog.participantPopup.button.select']}"
								styleClass="button" action="#{securityDialog.addUserPrev}" />
							<ice:commandButton
								value="#{securityDialog.messages['securityDialog.participantPopup.button.cancel']}"
								styleClass="button"
								action="#{securityDialog.closeAddEntryDialog}" />
						</ice:panelGrid>
					</ice:panelGroup>
				</f:facet>
			</ice:panelBorder>
		</f:facet>
	</ice:panelPopup>

</f:view>