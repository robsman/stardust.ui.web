<html>
  <head>
  	<link href="/../../plugins/views-common/css/thirdparty/jquery/jquery-ui-1.10.2.custom.css" rel="stylesheet"
		type="text/css" />
	<script src="../../../html5-process-portal/standalone/html5Deps.js"></script>
	<script data-main="../../scripts/utils/correspondenceViewMain"
		src="../../../views-common/js/libs/require/2.1.15/require.min.js"></script>
	<script  src="../../../processportal/js/Interaction.js"></script>
	<link href="../../styles/html5-views-common.css" rel="stylesheet">
	<link href="../../styles/stardust-modern.css" rel="stylesheet">
</head>
<body>
<div ng-cloak class="view-panel" ng-controller="sdCorrespondenceCtrl as ctrl" >
	<table class="correspondence_container">
		<tr class="correspondence_section">
			<td class="correspondence_left_section">
				<span class="iceOutLbl">Type : </span>
			</td>
			<td class="correspondence_right_section">	
				<select ng-model="ctrl.selected.type" class="correspondence_type_selector" ng-disabled="ctrl.readOnly"
			  	ng-change="ctrl.onTypeChange();"
				ng-options="opt.id as opt.label for opt in ctrl.correspondenceTypes">
			</select>
			</td>
		</tr>
		<tr class="correspondence_section" ng-if="ctrl.selected.type == 'email' ">
			<td class="correspondence_left_section"> 
				<a class="iceOutLbl" href="#" ng-click="ctrl.openAddressSelector('TO');" ng-if="!ctrl.readOnly"> To : </a>
				<span class="iceOutLbl" ng-if="ctrl.readOnly"> To : </span>
			</td>
			<td class="correspondence_right_section">	
				<div class="address-book-field-container">
					 <div sd-auto-complete 
		                            sda-item-pre-class="ctrl.addressIconMapper(item,index)" 
		                            sda-tag-pre-class="ctrl.addressIconMapper(item,index)" 
		                            sda-matches="ctrl.data.like.to" 
		                            sda-user-entry-delimiter=","
	           						sda-user-entry="ctrl.newItemFactory(val)"
		                            sda-match-str="ctrl.data.matchVal.to" 
		                            sda-change="ctrl.getAddressesAutoCompleteTO(ctrl.data.matchVal.to)" 
		                            sda-text-property="name" 
		                            sda-tooltip-property="value"
		                            sda-container-class="address-book-ac-container" 
		                            sda-item-hot-class="sd-ac-item-isActive" 
		                            sda-selected-matches="ctrl.selected.to"
		                            sda-read-only ="ctrl.readOnly"
		                            >
	                     </div>
                    </div> 
			</td>
		</tr>
		
	
		
		<tr class="correspondence_section" ng-if="ctrl.selected.type == 'email' && ctrl.selected.showBcc">
			<td class="correspondence_left_section"> 
				<a class="iceOutLbl" href="#" ng-click="ctrl.openAddressSelector('BCC');" ng-if="!ctrl.readOnly"> Bcc : </a>
				<span class="iceOutLbl" ng-if="ctrl.readOnly"> Bcc : </span>
			</td>
			<td class="correspondence_right_section">	
				<div class="address-book-field-container">
				 <div sd-auto-complete 
	                            sda-item-pre-class="ctrl.addressIconMapper(item,index)" 
	                            sda-tag-pre-class="ctrl.addressIconMapper(item,index)" 
	                            sda-matches="ctrl.data.like.bcc" 
	                            sda-user-entry-delimiter=","
           						sda-user-entry="ctrl.newItemFactory(val)"
	                            sda-match-str="ctrl.data.matchVal.bcc" 
	                            sda-change="ctrl.getAddressesAutoCompleteBCC(ctrl.data.matchVal.bcc)" 
	                            sda-text-property="name" 
	                            sda-tooltip-property="value"
	                            sda-container-class="address-book-ac-container" 
	                            sda-item-hot-class="sd-ac-item-isActive" 
	                            sda-selected-matches="ctrl.selected.bcc"
	                            sda-read-only ="ctrl.readOnly"
	                            >
                     </div>
                    </div> 
			</td>
		</tr>
		
		<tr class="correspondence_section" ng-if="ctrl.selected.type == 'email'&& ctrl.selected.showCc">
			<td class="correspondence_left_section"> 
				<a class="iceOutLbl" href="#" ng-click="ctrl.openAddressSelector('CC');"  ng-if="!ctrl.readOnly"> Cc : </a>
				<span class="iceOutLbl" ng-if="ctrl.readOnly"> Cc : </span>
			</td>
			<td class="correspondence_right_section">	
				<div class="address-book-field-container">	
					 <div sd-auto-complete 
		                            sda-item-pre-class="ctrl.addressIconMapper(item,index)" 
		                            sda-tag-pre-class="ctrl.addressIconMapper(item,index)" 
		                            sda-matches="ctrl.data.like.cc" 
		                            sda-user-entry-delimiter=","
	           						sda-user-entry="ctrl.newItemFactory(val)"
		                            sda-match-str="ctrl.data.matchVal.cc" 
		                            sda-change="ctrl.getAddressesAutoCompleteCC(ctrl.data.matchVal.cc)" 
		                            sda-text-property="name"
		                            sda-tooltip-property="value" 
		                            sda-container-class="address-book-ac-container" 
		                            sda-item-hot-class="sd-ac-item-isActive" 
		                            sda-selected-matches="ctrl.selected.cc"
		                            sda-read-only ="ctrl.readOnly"
		                            >
	                     </div>
	              </div>
			</td>
		</tr>
		
		<tr ng-if="ctrl.selected.type == 'email'">
			<td class="correspondence_left_section"> 
			</td>
			<td class="correspondence_right_section">	
				<a ng-show="!ctrl.selected.showBcc" ng-click ="ctrl.showBcc();">Bcc</a> 	<a ng-show="!ctrl.selected.showCc" ng-click ="ctrl.showCc();">Cc</a>
			</td>
		</tr>
		
		<tr class="correspondence_section" ng-if="ctrl.selected.type == 'email'">
			<td class="correspondence_left_section"> 
				<span class="iceOutLbl">Subject : </span>
			</td>
			<td class="correspondence_right_section">	
				<input ng-model="ctrl.selected.subject" type="text" ng-disabled="ctrl.readOnly"/>
			</td>
		</tr>
		<tr class="correspondence_section">
			<td class="correspondence_left_section"> 
				<a class="iceOutLbl" href="#" ng-click="ctrl.openMessageTemplateSelector();"  ng-if="!ctrl.readOnly"> Message : </a>
				<span class="iceOutLbl" ng-if="ctrl.readOnly"> Message : </span>
			</td>
			<td class="correspondence_right_section">	
				<textarea data-ng-model="ctrl.selected.message" sd-rich-text-editor ng-disabled="ctrl.readOnly" sda-readOnly="{{ctrl.readOnly}}"> </textarea>
			</td>
		</tr>
		
		<tr class="correspondence_section">
			<td class="correspondence_left_section"> 
			</td>
			<td class="correspondence_right_section">	
				 <div style="float:left;padding-top: 10px;" ng-hide="ctrl.readOnly">
					 <button class="button" ng-click="ctrl.complete()" >Complete</button>
				     <button class="button" ng-click="ctrl.cancel()" >Cancel</button>
				</div> 
				<div style="float:right;padding-top: 10px;">
				  	<div ng-hide="ctrl.readOnly">
					  	<button  class="button-link tbl-toolbar-item tbl-tool-link spacing-right" ng-click="ctrl.openAttachmentSelector()">
				 		  	 <i class="glyphicon glyphicon-paperclip icon-lg"></i> 
					   </button>
						<input class="correspondence_addressBook_fax_control" type="checkbox"/>
						<span class="iceOutLbl">Convert to PDF </span>
					</div>
					
					<div  class="correspondence-file-uploader">
							<div ng-repeat="att in ctrl.selected.attachments"
								class="correspondence_attachments">
								<span class="iceOutLbl" ng-bind="att .name"> </span>
								<button
									class="button-link tbl-toolbar-item tbl-tool-link spacing-right"
									style="float: right" ng-hide="ctrl.readOnly"
									ng-click="ctrl.removeAttachment(att)">
									<i class="glyphicon glyphicon-remove"></i>
								</button>
							</div>

							<form id="uploadAttachmentForm" ng-hide="ctrl.readOnly"  method="post"  class="correspondence-file-uploader"
								enctype="multipart/form-data">
								<fieldset>
									<input type="hidden" id="MAX_FILE_SIZE" name="MAX_FILE_SIZE"
										value="300000" />
									<div>
									<!-- /	<label for="fileselect">Files to upload:</label>  -->
										<input type="file" id="fileselect" name="fileselect" multiple = "multiple"/>
										<div id="filedrag" >
											<button  class="button-link tbl-toolbar-item tbl-tool-link" ng-click="ctrl.uploadLocalFilesToServer();">
												<i class="glyphicon glyphicon-upload icon-1-5x"></i>
											</button>
											<div>Upload Process Attachment </div>
										</div>
										<span id="messages"> </span>
										
									</div>
									
								</fieldset>
							</form >
				</div>
			</td>
		</tr>
	</table>
		
	</div>
</body>
</html>