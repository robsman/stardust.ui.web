package org.eclipse.stardust.engine.extensions.velocity.tool;

import static org.junit.Assert.assertEquals;

import java.io.IOException;
import java.io.InputStream;

import org.apache.camel.CamelContext;
import org.apache.camel.impl.DefaultCamelContext;
import org.apache.camel.util.ResourceHelper;
import org.apache.commons.io.IOUtils;
import org.eclipse.stardust.engine.extensions.templating.core.ServiceException;
import org.eclipse.stardust.engine.extensions.templating.enricher.VelocityContextAppenderProcessor;
import org.junit.After;
import org.junit.Before;
import org.junit.Test;
import org.springframework.context.support.ClassPathXmlApplicationContext;

public class Base64EncoderToolTest
{
   private final String EXPECTED = "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";

   private CamelContext camelContext;

   @Before
   public void before()
   {
      this.camelContext = new DefaultCamelContext();
   }

   @After
   public void after() throws Exception
   {
      this.camelContext.stop();
   }

   @Test
   public void testEncodeBase64String() throws ServiceException, IOException
   {
      InputStream is = ResourceHelper.resolveMandatoryResourceAsInputStream(
            camelContext.getClassResolver(),
            "file:src/test/resources/custom/templates/simpleDocxTemplate.docx");
      Base64EncoderTool tool = new Base64EncoderTool();
      assertEquals(EXPECTED, tool.encodeBase64String(IOUtils.toByteArray(is)));
   }

   @Test
   public void testLoadVelocityContextAndEncodeBase64String()
         throws ServiceException, IOException
   {
      ClassPathXmlApplicationContext ctx = new ClassPathXmlApplicationContext(
            new String[] {
                  "classpath:META-INF/spring/templating-application-context.xml"});
      VelocityContextAppenderProcessor customVelocityContextAppender = (VelocityContextAppenderProcessor) ctx
            .getBean("customVelocityContextAppender");
      Base64EncoderTool tool = (Base64EncoderTool) customVelocityContextAppender
            .getVelocityContext().get("base64Encoder");
      InputStream is = ResourceHelper.resolveMandatoryResourceAsInputStream(
            camelContext.getClassResolver(),
            "file:src/test/resources/custom/templates/simpleDocxTemplate.docx");
      assertEquals(EXPECTED, tool.encodeBase64String(IOUtils.toByteArray(is)));
      ctx.close();
   }
}
